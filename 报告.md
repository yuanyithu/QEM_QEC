# PEC实验总结报告

## 1. 实验背景

本系列实验研究不同PEC（Probabilistic Error Cancellation，概率误差消除）方法在L层独立局域退极化噪声电路中的性能表现。

## 2. 基础噪声模型

### 2.1 单比特退极化噪声信道

单比特上的Pauli噪声信道表示为：

$$
\mathcal{D}(p_x, p_y, p_z) = (1-p_x-p_y-p_z)\mathcal{I} + p_x\mathcal{X} + p_y\mathcal{Y} + p_z\mathcal{Z}
$$

## 3. 主要实验方法

### 3.1 纯PEC方法 (pure_PEC_.py)

#### 3.1.1 总PEC方法 (Total PEC)

**Protocol描述：**
在L层噪声之后，对整个噪声信道$\mathcal{N}_L$执行一次PEC。由于中间每一层都是简单的单比特噪声，可以直接计算出等效的总的单比特错误率$p^{(L)}$来节省经典计算资源。

**数学表达式：**
$$
\mathcal{N}_L = \mathcal{D}^{\otimes n}(p_x^{(L)}, p_y^{(L)}, p_z^{(L)})
$$

**复杂度分析：**
准概率向量：$c_m = \frac{1}{4^n} \sum_{i,j,k,l} [\mathcal{P}_m]_{ijkl} [\mathcal{N}_L^{-1}]_{jilk}$ （注：使用张量收缩而非trace操作）
采样成本：$\gamma_{\text{total}}^2 = \left( \sum_{m=1}^{4^n} |c_m| \right)^2$

#### 3.1.2 分层PEC方法 (Layered PEC)

**Protocol描述：**
在每一层噪声$\mathcal{N}$之后都执行一次PEC，总共执行L次PEC。

**数学表达式：**
每层噪声：$\mathcal{N} = \mathcal{D}_p^{\otimes n}$
总噪声信道：$\mathcal{N}_L = (\mathcal{N})^L$

**复杂度分析：**
每层PEC采样成本：$\gamma^2 = \left( \sum_{m=1}^{4^n} |c_m| \right)^2$
总采样成本：$\gamma_{\text{layered}}^2 = (\gamma^2)^L = \gamma^{2L}$

**为什么复杂度是$\gamma^{2L}$：**
因为每一层都需要独立的PEC操作，而PEC的采样成本是准概率向量1-范数的平方，所以L层就是$\gamma^{2L}$。

### 3.2 子空间PEC方法 (subspace_PEC.py)

**Protocol描述：**
在逻辑子空间内执行PEC，通过后选择（post-selection）来增强PEC效果。

**数学框架：**

1. **投影信道生成：**
$$
\mathcal{P} = \prod_{i=1}^{k} \frac{I + S_i}{2}
$$
其中$S_i$是稳定子算符。

2. **后选择过程：**
$$
P_{\text{success}} = \text{Tr}[\mathcal{P} \circ \mathcal{N}(\rho)]$
$$

其中$\rho$是逻辑最大混态。

3. **约化噪声信道：**
$$
\tilde{\mathcal{N}} = \frac{\mathcal{P} \circ \mathcal{N}}{P_{\text{success}}}
$$

4. **传输向量计算：**
$$
\lambda_j = \sum_{i=1}^{4^k} c_i (-1)^{\langle P_i, P_j \rangle}
$$

5. **系数向量求解：**
$$
c_i = \frac{1}{4^k} \sum_{j=1}^{4^k} (-1)^{\langle P_i, P_j \rangle} \lambda_j
$$

**复杂度分析：**
内在PEC成本：$\left( \sum_m |c_m| \right)^2$
总成本：$\frac{\text{PEC样本成本}}{P_{\text{success}}}$
生存概率：$P_{\text{success}}$

### 3.3 分层子空间PEC方法 (layered_subspace_PEC.py)

**Protocol描述：**
将L层电路分成多个检查间隔，在每个检查间隔执行子空间PEC。

**数学表达式：**
$$
\mathcal{N}_L = \mathcal{N}_{L_{\text{check}}}^{\lfloor L/L_{\text{check}} \rfloor} \circ \mathcal{N}_{L \bmod L_{\text{check}}}
$$

**复杂度分析：**
总采样成本：$\gamma_{\text{total}}^2 = \gamma_{\text{check}}^{2\lfloor L/L_{\text{check}} \rfloor} \times \gamma_{\text{remainder}}^2$

### 3.4 无后选择子空间PEC方法 (layered_nopostselection_subspace_PEC.py)

**Protocol描述：**
考虑不同符号组合的投影信道，分析所有可能的子空间。

**数学表达式：**
$$
\mathcal{P}_{\text{signs}} = \prod_{i=1}^{k} \frac{I + \text{signs}[i] \cdot S_i}{2}
$$

## 4. 实验参数设定

### 4.1 通用参数
- 噪声模型：单比特Pauli噪声信道
- 电路类型：L层独立局域退极化噪声电路

### 4.2 特定实验参数

| 实验方法 | 量子比特数 | 错误率 | 层数范围 | 检查间隔 |
|---------|------------|--------|----------|----------|
| 纯PEC | n=4 | p=0.0003 | L=1-3000 | - |
| 子空间PEC | n=4 | p=0.0003 | L=1-3000 | - |
| 分层子空间PEC | n=6 | p=0.0003 | L=1-3000 | L_check=1-3000 |
| 无后选择子空间PEC | n=6 | p=0.0003 | L=3001 | L_check=100 |

## 5. 实验目标

### 5.1 主要研究问题

1. PEC方法比较：Total PEC vs Layered PEC
2. 子空间效应：逻辑子空间对PEC效率的影响
3. 分层优化：检查间隔对总采样成本的影响
4. 后选择策略：不同投影符号组合的性能差异

### 5.2 性能指标

1. 内在PEC成本：$\left( \sum_m |c_m| \right)^2$
2. 总成本：$\frac{\text{PEC样本成本}}{P_{\text{success}}}$
3. 生存概率：$P_{\text{success}}$
4. 采样效率：随电路深度$L$的变化规律

## 6. 结论

本系列实验系统地研究了不同PEC方法在纯粹L层独立局域退极化噪声电路中的性能表现，特别关注了子空间方法和分层优化策略对采样效率的影响。